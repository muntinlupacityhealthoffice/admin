<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CITY HEALTH OFFICE Admin Dashboard</title>
    <!-- Use the Inter font from Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f4f8; /* A light blue-gray background */
        }
        .header-bg {
            background-color: #ffd700; /* Yellow background for the header */
            background-image: linear-gradient(to right, #ffd700, #ffeb3b); /* Gradient for a nicer look */
        }
        .header-bg-dark {
            background-color: #007bff; /* Blue background for the second header */
        }
        .button-bg {
            background-color: #fff9c4; /* Light yellow for buttons */
        }
        .button-bg:hover {
            background-color: #ffeb3b; /* A darker yellow on hover */
        }
        .text-dark-blue {
            color: #1a237e; /* Dark blue text */
        }
        .logo-shadow {
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        /* Modal-specific styling */
        .modal {
            display: none;
            position: fixed;
            z-index: 50;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.4);
            justify-content: center;
            align-items: center;
        }
    </style>
    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
</head>
<body class="min-h-screen flex flex-col items-center">

    <!-- Header Section -->
    <header class="w-full header-bg shadow-lg">
        <div class="container mx-auto px-4 py-4 flex items-center justify-between">
            <div class="flex items-center space-x-4">
                <div class="logo-shadow rounded-full p-2 bg-white flex items-center justify-center">
                    <img src="https://placehold.co/48x48/ffeb3b/1a237e?text=CHO" alt="City Health Office Logo" class="rounded-full w-12 h-12">
                </div>
                <div class="flex flex-col">
                    <h1 class="text-xl md:text-2xl font-bold text-dark-blue">CITY HEALTH OFFICE</h1>
                    <h2 class="text-lg md:text-xl font-medium text-dark-blue">Admin Dashboard--- Appointments</h2>
                </div>
            </div>
            <div class="hidden md:flex items-center space-x-2">
                <input id="searchInput" type="text" placeholder="search" class="px-4 py-2 border rounded-full focus:outline-none focus:ring-2 focus:ring-yellow-500">
                <button id="clearButton" class="bg-gray-300 text-gray-700 px-4 py-2 rounded-full font-semibold hover:bg-gray-400 transition">CLEAR</button>
            </div>
        </div>
        <div class="w-full h-2 header-bg-dark"></div>
    </header>

    <!-- Main Content Section -->
    <main class="container mx-auto p-8 flex-grow">
        <div id="healthCentersGrid" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
            <!-- Health Center Links (Generated by JavaScript) -->
        </div>
    </main>

    <!-- Footer Section -->
    <footer class="w-full header-bg py-4 mt-auto shadow-inner">
        <div class="container mx-auto px-4 flex items-center justify-center">
            <p class="text-sm text-dark-blue font-semibold">CITY HEALTH OFFICE</p>
        </div>
    </footer>

    <!-- Data Display Modal -->
    <div id="dataModal" class="modal">
        <div class="bg-white p-6 rounded-lg shadow-xl max-w-lg w-full">
            <div class="flex justify-between items-center border-b pb-3 mb-3">
                <h3 id="modalTitle" class="text-xl font-semibold text-dark-blue">Health Center Data</h3>
                <button id="closeModal" class="text-gray-500 hover:text-gray-700 font-bold text-2xl">&times;</button>
            </div>
            <div id="modalContent" class="max-h-96 overflow-y-auto">
                <!-- Data will be injected here -->
            </div>
        </div>
    </div>

    <script>
        // Firebase configuration
        const firebaseConfig = {
            databaseURL: "https://cho-clinic-default-rtdb.asia-southeast1.firebasedatabase.app/"
        };
        // Initialize Firebase
        const app = firebase.initializeApp(firebaseConfig);
        const database = app.database();

        document.addEventListener('DOMContentLoaded', () => {
            const healthCenters = [
                'TUNASAN HEALTH CENTER',
                'VICTORIA HEALTH CENTER',
                'LAGUERTA HEALTH CENTER',
                'POBLACION HEALTH CENTER',
                'SOUTHVILLE HEALTH CENTER',
                'PUTATAN HEALTH CENTER',
                'PUTATAN ANNEX HEALTH CENTER',
                'LAKEVIEW HEALTH CENTER',
                'BAYANAN MAIN HEALTH CENTER',
                'ALABANG HEALTH CENTER',
                'AYALA ALABANG HEALTH CENTER',
                'CUPANG HEALTH CENTER',
                'SITIO STO. NINO HEALTH CENTER',
                'BULI HEALTH CENTER',
                'SUCAT HEALTH CENTER',
                'BAGONG SILANG HEALTH CENTER',
            ];

            const gridContainer = document.getElementById('healthCentersGrid');
            const searchInput = document.getElementById('searchInput');
            const clearButton = document.getElementById('clearButton');
            const modal = document.getElementById('dataModal');
            const modalTitle = document.getElementById('modalTitle');
            const modalContent = document.getElementById('modalContent');
            const closeModalBtn = document.getElementById('closeModal');

            // Function to generate a URL slug from the health center name
            const createSlug = (name) => {
                return name.toLowerCase().replace(/\s+/g, '-');
            };

            // Function to render health center links
            const renderHealthCenters = (centers) => {
                gridContainer.innerHTML = ''; // Clear existing content
                centers.forEach(center => {
                    const slug = createSlug(center);
                    const linkHtml = `
                        <a href="#" data-center="${center}" class="button-bg rounded-lg shadow-md p-4 text-center font-semibold text-dark-blue hover:shadow-lg transition transform hover:scale-105">
                            ${center}
                        </a>
                    `;
                    gridContainer.innerHTML += linkHtml;
                });
            };

            // Initial render of all health centers
            renderHealthCenters(healthCenters);

            // Add event listener to the search input
            searchInput.addEventListener('input', (e) => {
                const searchTerm = e.target.value.toLowerCase();
                const filteredCenters = healthCenters.filter(center => 
                    center.toLowerCase().includes(searchTerm)
                );
                renderHealthCenters(filteredCenters);
            });

            // Add event listener to the clear button
            clearButton.addEventListener('click', () => {
                searchInput.value = ''; // Clear the input field
                renderHealthCenters(healthCenters); // Show all health centers
            });

            // Handle link clicks to show data
            gridContainer.addEventListener('click', (e) => {
                // Check if the clicked element is a health center link
                const targetLink = e.target.closest('a[data-center]');
                if (targetLink) {
                    e.preventDefault(); // Prevent default link behavior
                    const centerName = targetLink.getAttribute('data-center');
                    showDataForCenter(centerName);
                }
            });

            // Function to show modal with data
            const showDataForCenter = (centerName) => {
                modalTitle.textContent = centerName;
                modalContent.innerHTML = '<p class="text-center text-gray-500">Loading data...</p>';
                modal.style.display = 'flex';

                const slug = createSlug(centerName);
                const dbRef = database.ref('health-centers/' + slug);

                dbRef.once('value')
                    .then(snapshot => {
                        const data = snapshot.val();
                        if (data && data.appointments) {
                            let contentHtml = '<h4 class="font-bold text-lg mb-2">Appointments</h4>';
                            if (Object.keys(data.appointments).length > 0) {
                                contentHtml += '<ul class="list-disc list-inside space-y-2">';
                                for (const key in data.appointments) {
                                    const appointment = data.appointments[key];
                                    contentHtml += `
                                        <li class="p-2 border-b border-gray-200 last:border-b-0">
                                            <span class="font-medium">${appointment.name}</span> - ${appointment.service} on ${appointment.date}
                                        </li>
                                    `;
                                }
                                contentHtml += '</ul>';
                            } else {
                                contentHtml = '<p class="text-center text-gray-500">No appointments found for this center.</p>';
                            }
                            modalContent.innerHTML = contentHtml;
                        } else {
                            modalContent.innerHTML = '<p class="text-center text-gray-500">No data found for this health center.</p>';
                        }
                    })
                    .catch(error => {
                        console.error("Error fetching data:", error);
                        modalContent.innerHTML = '<p class="text-center text-red-500">Error fetching data. Please check your network connection and database rules.</p>';
                    });
            };

            // Close the modal when the close button is clicked
            closeModalBtn.addEventListener('click', () => {
                modal.style.display = 'none';
            });

            // Close the modal when clicking outside of it
            window.addEventListener('click', (e) => {
                if (e.target === modal) {
                    modal.style.display = 'none';
                }
            });
        });
    </script>

</body>
</html>

