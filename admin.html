<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CITY HEALTH OFFICE Admin Dashboard</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f4f8; /* A light blue-gray background */
        }
        .header-bg {
            background-color: #ffd700; /* Yellow background for the header */
            background-image: linear-gradient(to right, #ffd700, #ffeb3b); /* Gradient for a nicer look */
        }
        .header-bg-dark {
            background-color: #007bff; /* Blue background for the second header */
        }
        .button-bg {
            background-color: #fff9c4; /* Light yellow for buttons */
        }
        .button-bg:hover {
            background-color: #ffeb3b; /* A darker yellow on hover */
        }
        .text-dark-blue {
            color: #1a237e; /* Dark blue text */
        }
        .logo-shadow {
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        /* Modal-specific styling */
        .modal {
            display: none;
            position: fixed;
            z-index: 50;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.4);
            justify-content: center;
            align-items: center;
        }
    </style>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
</head>
<body class="min-h-screen flex flex-col items-center">

    <header class="w-full header-bg shadow-lg">
        <div class="container mx-auto px-4 py-4 flex items-center justify-between">
            <div class="flex items-center space-x-4">
                <img src="https://i.ibb.co/L150B20/Screenshot-2025-09-08-224815.png" alt="City Health Logo" class="rounded-full w-20 h-20 shadow-lg">
                <div class="flex flex-col">
                    <h1 class="text-xl md:text-2xl font-bold text-dark-blue">CITY HEALTH OFFICE</h1>
                    <h2 class="text-lg md:text-xl font-medium text-dark-blue">Admin Dashboard--- Appointments</h2>
                </div>
            </div>
            <div class="hidden md:flex items-center space-x-2">
                <input id="searchInput" type="text" placeholder="search" class="px-4 py-2 border rounded-full focus:outline-none focus:ring-2 focus:ring-yellow-500">
                <button id="clearButton" class="bg-gray-300 text-gray-700 px-4 py-2 rounded-full font-semibold hover:bg-gray-400 transition">CLEAR</button>
            </div>
        </div>
        <div class="w-full h-2 header-bg-dark"></div>
    </header>

    <main class="container mx-auto p-8 flex-grow">
        <div id="healthCentersGrid" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
        </div>
    </main>

    <footer class="w-full header-bg mt-12 border-t-4 border-blue-400">
        <div class="container mx-auto py-4 text-center text-gray-800 font-medium">
            MUNTINLUPA CITY HEALTH OFFICE
        </div>
    </footer>

    <div id="dataModal" class="modal">
        <div class="bg-white p-6 rounded-lg shadow-xl max-w-lg w-full">
            <div class="flex justify-between items-center border-b pb-3 mb-3">
                <h3 id="modalTitle" class="text-xl font-semibold text-dark-blue">Health Center Data</h3>
                <button id="closeModal" class="text-gray-500 hover:text-gray-700 font-bold text-2xl">&times;</button>
            </div>
            <div id="modalContent" class="max-h-96 overflow-y-auto">
            </div>
        </div>
    </div>

    <script>
        // Your web app's Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyCoBZyS0BKZe1MMG78WpiK9tFQAZBd-wKg",
            authDomain: "cho-clinic.firebaseapp.com",
            databaseURL: "https://cho-clinic-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "cho-clinic",
            storageBucket: "cho-clinic.firebasestorage.app",
            messagingSenderId: "1078609107976",
            appId: "1:1078609107976:web:11cfb6afccf463fc17c5bd",
            measurementId: "G-FHE4TNMD0X"
        };

        // Initialize Firebase
        const app = firebase.initializeApp(firebaseConfig);
        const database = app.database();

        document.addEventListener('DOMContentLoaded', () => {
            const healthCentersGrid = document.getElementById('healthCentersGrid');
            const searchInput = document.getElementById('searchInput');
            const clearButton = document.getElementById('clearButton');
            const dataModal = document.getElementById('dataModal');
            const modalTitle = document.getElementById('modalTitle');
            const modalContent = document.getElementById('modalContent');
            const closeModalButton = document.getElementById('closeModal');

            const healthCenters = [
                'TUNASAN HEALTH CENTER',
                'VICTORIA HEALTH CENTER',
                'LAGUERTA HEALTH CENTER',
                'POBLACION HEALTH CENTER',
                'SOUTHVILLE HEALTH CENTER',
                'PUTATAN HEALTH CENTER',
                'PUTATAN ANNEX HEALTH CENTER',
                'LAKEVIEW HEALTH CENTER',
                'BAYANAN MAIN HEALTH CENTER',
                'ALABANG HEALTH CENTER',
                'AYALA ALABANG HEALTH CENTER',
                'CUPANG HEALTH CENTER',
                'SITIO STO. NINO HEALTH CENTER',
                'BULI HEALTH CENTER',
                'SUCAT HEALTH CENTER',
                'BAGONG SILANG HEALTH CENTER',
            ];

            function createHealthCenterCard(centerName) {
                const card = document.createElement('div');
                card.classList.add('bg-white', 'rounded-lg', 'shadow-md', 'p-6', 'flex', 'flex-col', 'items-center', 'text-center', 'transition', 'transform', 'hover:scale-105', 'hover:shadow-xl', 'cursor-pointer');
                
                const name = document.createElement('h3');
                name.textContent = centerName;
                name.classList.add('text-lg', 'font-semibold', 'text-dark-blue', 'mb-2');
                card.appendChild(name);

                const viewButton = document.createElement('button');
                viewButton.textContent = 'View Appointments';
                viewButton.classList.add('mt-2', 'px-4', 'py-2', 'rounded-full', 'font-semibold', 'button-bg', 'text-dark-blue', 'hover:bg-yellow-400', 'transition');
                viewButton.addEventListener('click', () => {
                    showModal(centerName);
                });
                card.appendChild(viewButton);
                
                return card;
            }

            function renderHealthCenters(filter = '') {
                healthCentersGrid.innerHTML = '';
                const filteredCenters = healthCenters.filter(center => 
                    center.toLowerCase().includes(filter.toLowerCase())
                );
                
                filteredCenters.forEach(center => {
                    const card = createHealthCenterCard(center);
                    healthCentersGrid.appendChild(card);
                });
            }

            function showModal(centerName) {
                modalTitle.textContent = `Appointments for ${centerName}`;
                modalContent.innerHTML = `<p class="text-center text-gray-500">Loading appointments...</p>`;
                dataModal.style.display = 'flex';

                const databasePath = `appointments/${centerName}`;
                const centerRef = database.ref(databasePath);

                centerRef.on('value', (snapshot) => {
                    const data = snapshot.val();
                    modalContent.innerHTML = ''; // Clear previous content

                    if (data) {
                        const appointmentsList = document.createElement('div');
                        appointmentsList.classList.add('space-y-4');

                        for (const date in data) {
                            if (data.hasOwnProperty(date)) {
                                const dailyAppointments = data[date];
                                
                                const dateSection = document.createElement('div');
                                dateSection.classList.add('border', 'border-gray-200', 'rounded-md', 'p-4');

                                const dateHeading = document.createElement('h4');
                                dateHeading.classList.add('font-bold', 'text-lg', 'text-dark-blue', 'mb-2');
                                dateHeading.textContent = `Date: ${date}`;
                                dateSection.appendChild(dateHeading);

                                const dailyList = document.createElement('ul');
                                dailyList.classList.add('list-disc', 'pl-5');

                                for (const appointmentId in dailyAppointments) {
                                    if (dailyAppointments.hasOwnProperty(appointmentId)) {
                                        const appointment = dailyAppointments[appointmentId];
                                        const listItem = document.createElement('li');
                                        listItem.classList.add('text-gray-700');
                                        listItem.innerHTML = `
                                            <strong>Name:</strong> ${appointment.name}<br>
                                            <strong>Time:</strong> ${appointment.time}<br>
                                            <strong>Purpose:</strong> ${appointment.purpose}
                                        `;
                                        dailyList.appendChild(listItem);
                                    }
                                }
                                dateSection.appendChild(dailyList);
                                appointmentsList.appendChild(dateSection);
                            }
                        }
                        modalContent.appendChild(appointmentsList);
                    } else {
                        modalContent.innerHTML = `<p class="text-center text-gray-500">No appointments found for ${centerName}.</p>`;
                    }
                }, (error) => {
                    console.error("Firebase fetch failed:", error);
                    modalContent.innerHTML = `<p class="text-center text-red-500">Failed to load data. Please try again.</p>`;
                });
            }

            function hideModal() {
                dataModal.style.display = 'none';
            }

            searchInput.addEventListener('keyup', (e) => {
                renderHealthCenters(e.target.value);
            });

            clearButton.addEventListener('click', () => {
                searchInput.value = '';
                renderHealthCenters();
            });

            closeModalButton.addEventListener('click', hideModal);

            window.addEventListener('click', (e) => {
                if (e.target === dataModal) {
                    hideModal();
                }
            });

            renderHealthCenters();
        });
    </script>
</body>
</html>
